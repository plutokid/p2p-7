(function(a,b){function e(){c||(c={verbose:!1,queryLimit:{attempt:5,delay:250,random:250},classes:{Map:google.maps.Map,Marker:google.maps.Marker,InfoWindow:google.maps.InfoWindow,Circle:google.maps.Circle,Rectangle:google.maps.Rectangle,OverlayView:google.maps.OverlayView,StreetViewPanorama:google.maps.StreetViewPanorama,KmlLayer:google.maps.KmlLayer,TrafficLayer:google.maps.TrafficLayer,BicyclingLayer:google.maps.BicyclingLayer,GroundOverlay:google.maps.GroundOverlay,StyledMapType:google.maps.StyledMapType,ImageMapType:google.maps.ImageMapType},map:{mapTypeId:google.maps.MapTypeId.ROADMAP,center:[46.578498,2.457275],zoom:2},overlay:{pane:"floatPane",content:"",offset:{x:0,y:0}},geoloc:{getCurrentPosition:{maximumAge:6e4,timeout:5e3}}})}function f(a,c){return a!==b?a:"gmap3_"+(c?d+1:++d)}function g(b,c,d,e,f){if(c.todo.events||c.todo.onces)var g={id:e,data:c.todo.data,tag:c.todo.tag};c.todo.events&&a.each(c.todo.events,function(a,c){google.maps.event.addListener(d,a,function(a){c.apply(b,[f?f:d,a,g])})}),c.todo.onces&&a.each(c.todo.onces,function(a,c){google.maps.event.addListenerOnce(d,a,function(a){c.apply(b,[f?f:d,a,g])})})}function h(){var a=[];this.empty=function(){return!a.length},this.add=function(b){a.push(b)},this.get=function(){return a.length?a[0]:!1},this.ack=function(){a.shift()}}function i(b,d,e){function j(a){var b={};return b[a]={},b}function k(){var a;for(a in e)if(!(a in f))return a}var h,f={},g=this,i={latLng:{map:!1,marker:!1,infowindow:!1,circle:!1,overlay:!1,getlatlng:!1,getmaxzoom:!1,getelevation:!1,streetviewpanorama:!1,getaddress:!0},geoloc:{getgeoloc:!0}};"string"==typeof e&&(e=j(e)),this.run=function(){for(var g,j;g=k();){if("function"==typeof b[g])return h=g,j=a.extend(!0,{},c[g]||{},e[g].options||{}),g in i.latLng?e[g].values?F(e[g].values,b,b[g],{todo:e[g],opts:j,session:f}):E(b,b[g],i.latLng[g],{todo:e[g],opts:j,session:f}):g in i.geoloc?G(b,b[g],{todo:e[g],opts:j,session:f}):b[g].apply(b,[{todo:e[g],opts:j,session:f}]),void 0;f[g]=null}d.apply(b,[e,f])},this.ack=function(a){f[h]=a,g.run.apply(g,[])}}function j(a){var b,c=[];for(b in a)c.push(b);return c}function k(b,c){var d={};if(b.todo)for(var e in b.todo)"options"!==e&&"values"!==e&&(d[e]=b.todo[e]);var f,g=["data","tag","id","events","onces"];for(f=0;g.length>f;f++)l(d,g[f],c,b.todo);return d.options=a.extend({},b.todo.options||{},c.options||{}),d}function l(a,b){for(var c=2;arguments.length>c;c++)if(b in arguments[c])return a[b]=arguments[c][b],void 0}function m(){var a=[];this.get=function(b){if(a.length){var c,d,e,f,g,h=j(b);for(c=0;a.length>c;c++){for(f=a[c],g=h.length==f.keys.length,d=0;h.length>d&&g;d++)e=h[d],g=e in f.request,g&&(g="object"==typeof b[e]&&"equals"in b[e]&&"function"==typeof b[e]?b[e].equals(f.request[e]):b[e]===f.request[e]);if(g)return f.results}}},this.store=function(b,c){a.push({request:b,keys:j(b),results:c})}}function n(b,d,e,f){var g=this,h=[];c.classes.OverlayView.call(this),this.setMap(b),this.onAdd=function(){var b=this.getPanes();d.pane in b&&a(b[d.pane]).append(f),a.each("dblclick click mouseover mousemove mouseout mouseup mousedown".split(" "),function(b,c){h.push(google.maps.event.addDomListener(f[0],c,function(b){a.Event(b).stopPropagation(),google.maps.event.trigger(g,c,[b])}))}),h.push(google.maps.event.addDomListener(f[0],"contextmenu",function(b){a.Event(b).stopPropagation(),google.maps.event.trigger(g,"rightclick",[b])})),this.draw()},this.getPosition=function(){return e},this.draw=function(){this.draw=function(){var a=this.getProjection().fromLatLngToDivPixel(e);f.css("left",a.x+d.offset.x+"px").css("top",a.y+d.offset.y+"px")}},this.onRemove=function(){for(var a=0;h.length>a;a++)google.maps.event.removeListener(h[a]);f.remove()},this.hide=function(){f.hide()},this.show=function(){f.show()},this.toggle=function(){f&&(f.is(":visible")?this.show():this.hide())},this.toggleDOM=function(){this.getMap()?this.setMap(null):this.setMap(b)},this.getDOMElement=function(){return f[0]}}function o(a){function b(){return this.onAdd=function(){},this.onRemove=function(){},this.draw=function(){},c.classes.OverlayView.apply(this,[])}b.prototype=c.classes.OverlayView.prototype;var d=new b;return d.setMap(a),d}function p(c,d,e,h){function B(){return(x=v.getProjection())?(l=!0,p.push(google.maps.event.addListener(d,"zoom_changed",function(){G()})),p.push(google.maps.event.addListener(d,"bounds_changed",function(){G()})),I(),void 0):(setTimeout(function(){B.apply(n,[])},25),void 0)}function C(a){"object"==typeof q[a]?("function"==typeof q[a].obj.setMap&&q[a].obj.setMap(null),"function"==typeof q[a].obj.remove&&q[a].obj.remove(),"function"==typeof q[a].shadow.remove&&q[a].obj.remove(),"function"==typeof q[a].shadow.setMap&&q[a].shadow.setMap(null),delete q[a].obj,delete q[a].shadow):s[a]&&s[a].setMap(null),delete q[a]}function D(){var a,b,c,d,e,f,g,h;return arguments[0]instanceof google.maps.LatLng?(a=arguments[0].lat(),c=arguments[0].lng(),arguments[1]instanceof google.maps.LatLng?(b=arguments[1].lat(),d=arguments[1].lng()):(b=arguments[1],d=arguments[2])):(a=arguments[0],c=arguments[1],arguments[2]instanceof google.maps.LatLng?(b=arguments[2].lat(),d=arguments[2].lng()):(b=arguments[2],d=arguments[3])),e=Math.PI*a/180,f=Math.PI*c/180,g=Math.PI*b/180,h=Math.PI*d/180,6371e3*Math.acos(Math.min(Math.cos(e)*Math.cos(g)*Math.cos(f)*Math.cos(h)+Math.cos(e)*Math.sin(f)*Math.cos(g)*Math.sin(h)+Math.sin(e)*Math.sin(g),1))}function E(){var a=D(d.getCenter(),d.getBounds().getNorthEast()),b=new google.maps.Circle({center:d.getCenter(),radius:1.25*a});return b.getBounds()}function F(){var b,a={};for(b in q)a[b]=!0;return a}function G(){clearTimeout(w),w=setTimeout(function(){I()},25)}function H(a){var b=x.fromLatLngToDivPixel(a),c=x.fromDivPixelToLatLng(new google.maps.Point(b.x+e,b.y-e)),d=x.fromDivPixelToLatLng(new google.maps.Point(b.x-e,b.y+e));return new google.maps.LatLngBounds(d,c)}function I(){if(!i&&!k&&l){var o,p,r,s,v,w,x,B,D,c=[],e={},f=d.getZoom(),g=h!==b&&f>h,n=F(),A=!1;for(j=!1,f>3&&(B=E(),A=B.getSouthWest().lng()<B.getNorthEast().lng()),a.each(t,function(a,b){b&&(!A||B.contains(b.options.position))&&(!y||y(u[a]))&&c.push(a)});;){for(o=0;e[o]&&c.length>o;)o++;if(o==c.length)break;if(w=[],m&&!g){do{if(x=w,w=[],x.length){for(s=v=0,r=0;x.length>r;r++)s+=t[c[x[r]]].options.position.lat(),v+=t[c[x[r]]].options.position.lng();s/=x.length,v/=x.length,B=H(new google.maps.LatLng(s,v))}else B=H(t[c[o]].options.position);for(p=o;c.length>p;p++)e[p]||B.contains(t[c[p]].options.position)&&w.push(p)}while(x.length<w.length&&w.length>1)}else for(p=o;c.length>p;p++)if(!e[p]){w.push(p);break}for(D={latLng:B.getCenter(),indexes:[],ref:[]},r=0;w.length>r;r++)e[w[r]]=!0,D.indexes.push(c[w[r]]),D.ref.push(c[w[r]]);D.ref=D.ref.join("-"),D.ref in n?delete n[D.ref]:(1===w.length&&(q[D.ref]=!0),function(a){setTimeout(function(){z(a)},1)}(D))}a.each(n,function(a){C(a)}),k=!1}}var w,x,y,z,A,i=!1,j=!1,k=!1,l=!1,m=!0,n=this,p=[],q={},r={},s=[],t=[],u=[],v=o(d);B(),this.getById=function(a){return a in r?s[r[a]]:!1},this.clearById=function(a){if(a in r){var b=r[a];s[b]&&s[b].setMap(null),delete s[b],s[b]=!1,delete t[b],t[b]=!1,delete u[b],u[b]=!1,delete r[a],j=!0}},this.add=function(a,b){a.id=f(a.id),this.clearById(a.id),r[a.id]=s.length,s.push(null),t.push(a),u.push(b),j=!0},this.addMarker=function(a,b){b=b||{},b.id=f(b.id),this.clearById(b.id),b.options||(b.options={}),b.options.position=a.getPosition(),g(c,{todo:b},a,b.id),r[b.id]=s.length,s.push(a),t.push(b),u.push(b.data||{}),j=!0},this.todo=function(a){return t[a]},this.value=function(a){return u[a]},this.marker=function(a){return s[a]},this.setMarker=function(a,b){s[a]=b},this.store=function(a,b,c){q[a.ref]={obj:b,shadow:c}},this.free=function(){for(var b=0;p.length>b;b++)google.maps.event.removeListener(p[b]);p=[],a.each(q,function(a){C(a)}),q={},a.each(t,function(a){t[a]=null}),t=[],a.each(s,function(a){s[a]&&(s[a].setMap(null),delete s[a])}),s=[],a.each(u,function(a){delete u[a]}),u=[],r={}},this.filter=function(a){y=a,I()},this.enable=function(a){m!=a&&(m=a,I())},this.display=function(a){z=a},this.error=function(a){A=a},this.beginUpdate=function(){i=!0},this.endUpdate=function(){i=!1,j&&I()}}function q(a,b){this.id=function(){return a},this.filter=function(a){b.filter(a)},this.enable=function(){b.enable(!0)},this.disable=function(){b.enable(!1)},this.add=function(a,c,d){d||b.beginUpdate(),b.addMarker(a,c),d||b.endUpdate()},this.getById=function(a){return b.getById(a)},this.clearById=function(a,c){c||b.beginUpdate(),b.clearById(a),c||b.endUpdate()}}function r(){function e(c){return c?"function"==typeof c?c:(c=B(c),function(d){if(d===b)return!1;if("object"==typeof d){for(var e=0;d.length>e;e++)if(a.inArray(d[e],c)>=0)return!0;return!1}return a.inArray(d,c)>=0}):void 0}function g(a){return{id:a.id,name:a.name,object:a.obj,tag:a.tag,data:a.data}}function h(a){"function"==typeof a.setMap&&a.setMap(null),"function"==typeof a.remove&&a.remove(),"function"==typeof a.free&&a.free(),a=null}var c={},d={};this.add=function(a,b,e,g){var h=a.todo||{},i=f(h.id);return c[b]||(c[b]=[]),i in d&&this.clearById(i),d[i]={obj:e,sub:g,name:b,id:i,tag:h.tag,data:h.data},c[b].push(i),i},this.getById=function(a,b,c){return a in d?b?d[a].sub:c?g(d[a]):d[a].obj:!1},this.get=function(a,b,f,h){var i,j,k=e(f);if(!c[a]||!c[a].length)return null;for(i=c[a].length;i;)if(i--,j=c[a][b?i:c[a].length-i-1],j&&d[j]){if(k&&!k(d[j].tag))continue;return h?g(d[j]):d[j].obj}return null},this.all=function(a,f,h){var i=[],j=e(f),k=function(a){var b,e;for(b=0;c[a].length>b;b++)if(e=c[a][b],e&&d[e]){if(j&&!j(d[e].tag))continue;i.push(h?g(d[e]):d[e].obj)}};if(a in c)k(a);else if(a===b)for(a in c)k(a);return i},this.rm=function(a,b,e){var f,g;if(!c[a])return!1;if(b)if(e)for(f=c[a].length-1;f>=0&&(g=c[a][f],!b(d[g].tag));f--);else for(f=0;c[a].length>f&&(g=c[a][f],!b(d[g].tag));f++);else f=e?c[a].length-1:0;return f in c[a]?this.clearById(c[a][f],f):!1},this.clearById=function(a,e){if(a in d){var f,g=d[a].name;for(f=0;e===b&&c[g].length>f;f++)a===c[g][f]&&(e=f);return h(d[a].obj),d[a].sub&&h(d[a].sub),delete d[a],c[g].splice(e,1),!0}return!1},this.objGetById=function(a){var b;if(c.clusterer)for(var e in c.clusterer)if((b=d[c.clusterer[e]].obj.getById(a))!==!1)return b;return!1},this.objClearById=function(a){if(c.clusterer)for(var b in c.clusterer)if(d[c.clusterer[b]].obj.clearById(a))return!0;return null},this.clear=function(a,b,d,f){var g,h,i,j=e(f);if(a&&a.length)a=B(a);else{a=[];for(g in c)a.push(g)}for(h=0;a.length>h;h++)if(a[h]){if(i=a[h],!c[i])continue;if(b)this.rm(i,j,!0);else if(d)this.rm(i,j,!1);else for(;this.rm(i,j,!1););}}}function u(){return s.geocoder||(s.geocoder=new google.maps.Geocoder),s.geocoder}function v(){return s.directionsService||(s.directionsService=new google.maps.DirectionsService),s.directionsService}function w(){return s.elevationService||(s.elevationService=new google.maps.ElevationService),s.elevationService}function x(){return s.maxZoomService||(s.maxZoomService=new google.maps.MaxZoomService),s.maxZoomService}function y(){return s.distanceMatrixService||(s.distanceMatrixService=new google.maps.DistanceMatrixService),s.distanceMatrixService}function z(){if(c.verbose){var a,b=[];if(window.console&&"function"==typeof console.error){for(a=0;arguments.length>a;a++)b.push(arguments[a]);console.error.apply(console,b)}else{for(b="",a=0;arguments.length>a;a++)b+=""+arguments[a]+" ";alert(b)}}}function A(a){return("number"==typeof a||"string"==typeof a)&&""!==a&&!isNaN(a)}function B(a){var c,d=[];if(a!==b)if("object"==typeof a)if("number"==typeof a.length)d=a;else for(c in a)d.push(a[c]);else d.push(a);return d}function C(b,c,d){var e=c?b:null;return b&&"string"!=typeof b?b.latLng?C(b.latLng):b instanceof google.maps.LatLng?b:A(b.lat)?new google.maps.LatLng(b.lat,b.lng):!d&&a.isArray(b)?A(b[0])&&A(b[1])?new google.maps.LatLng(b[0],b[1]):e:e:e}function D(b){var c,d;return!b||b instanceof google.maps.LatLngBounds?b||null:(a.isArray(b)?2==b.length?(c=C(b[0]),d=C(b[1])):4==b.length&&(c=C([b[0],b[1]]),d=C([b[2],b[3]])):"ne"in b&&"sw"in b?(c=C(b.ne),d=C(b.sw)):"n"in b&&"e"in b&&"s"in b&&"w"in b&&(c=C([b.n,b.e]),d=C([b.s,b.w])),c&&d?new google.maps.LatLngBounds(d,c):null)}function E(a,b,d,e,f){var g=d?C(e.todo,!1,!0):!1,h=g?{latLng:g}:e.todo.address?"string"==typeof e.todo.address?{address:e.todo.address}:e.todo.address:!1,i=h?t.get(h):!1,j=this;h?(f=f||0,i?(e.latLng=i.results[0].geometry.location,e.results=i.results,e.status=i.status,b.apply(a,[e])):(h.location&&(h.location=C(h.location)),h.bounds&&(h.bounds=D(h.bounds)),u().geocode(h,function(g,i){i===google.maps.GeocoderStatus.OK?(t.store(h,{results:g,status:i}),e.latLng=g[0].geometry.location,e.results=g,e.status=i,b.apply(a,[e])):i===google.maps.GeocoderStatus.OVER_QUERY_LIMIT&&c.queryLimit.attempt>f?setTimeout(function(){E.apply(j,[a,b,d,e,f+1])},c.queryLimit.delay+Math.floor(Math.random()*c.queryLimit.random)):(z("geocode failed",i,h),e.latLng=e.results=!1,e.status=i,b.apply(a,[e]))}))):(e.latLng=C(e.todo,!1,!0),b.apply(a,[e]))}function F(b,c,d,e){function h(){do g++;while(b.length>g&&!("address"in b[g]));return g>=b.length?(d.apply(c,[e]),void 0):(E(f,function(c){delete c.todo,a.extend(b[g],c),h.apply(f,[])},!0,{todo:b[g]}),void 0)}var f=this,g=-1;h()}function G(a,b,c){var d=!1;navigator&&navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){d||(d=!0,c.latLng=new google.maps.LatLng(e.coords.latitude,e.coords.longitude),b.apply(a,[c]))},function(){d||(d=!0,c.latLng=!1,b.apply(a,[c]))},c.opts.getCurrentPosition):(c.latLng=!1,b.apply(a,[c]))}function H(d){function s(){!o&&(o=j.get())&&o.run()}function t(){o=null,j.ack(),s.call(e)}function u(b){var c,e=[];for(c=1;arguments.length>c;c++)e.push(arguments[c]);"function"==typeof b.todo.callback?b.todo.callback.apply(d,e):"object"==typeof b.todo.callback&&a.each(b.todo.callback,function(a,b){"function"==typeof b&&b.apply(d,e)})}function A(a,b,c){c&&g(d,a,b,c),u(a,b),o.ack(b)}function E(b,e){if(e=e||{},m)e.todo&&e.todo.options&&m.setOptions(e.todo.options);else{var f=e.opts||a.extend(!0,{},c.map,e.todo&&e.todo.options?e.todo.options:{});f.center=b||C(f.center),m=new c.classes.Map(d.get(0),f)}}function F(b,c,e){var f=[],h="values"in b.todo;return h||(b.todo.values=[{options:b.opts}]),b.todo.values.length?(E(),a.each(b.todo.values,function(h,i){var j,n,o,p,q=k(b,i);if(q.options[e])if(q.options[e][0][0]&&a.isArray(q.options[e][0][0]))for(n=0;q.options[e].length>n;n++)for(o=0;q.options[e][n].length>o;o++)q.options[e][n][o]=C(q.options[e][n][o]);else for(n=0;q.options[e].length>n;n++)q.options[e][n]=C(q.options[e][n]);q.options.map=m,p=new google.maps[c](q.options),f.push(p),j=l.add({todo:q},c.toLowerCase(),p),g(d,{todo:q},p,j)}),A(b,h?f:f[0]),void 0):(A(b,!1),void 0)}function G(f){var l,n,h=new p(d,m,f.radius,f.maxZoom),i={},j={},k=/^[0-9]+$/;for(n in f)k.test(n)?(j[n]=f[n],j[n].width=j[n].width||0,j[n].height=j[n].height||0):i[n]=f[n];return l=i.calculator?function(b){var c=[];return a.each(b,function(a,b){c.push(h.value(b))}),i.calculator.apply(d,[c])}:function(a){return a.length},h.error(function(){z.apply(e,arguments)}),h.display(function(f){var k,n,p,q,r,o=0,s=l(f.indexes);if(s>1){for(k in j)k=1*k,k>o&&s>=k&&(o=k);n=j[o]}n?(r=n.offset||[-n.width/2,-n.height/2],p=a.extend({},i),p.options=a.extend({pane:"overlayLayer",content:n.content?n.content.replace("CLUSTER_COUNT",s):"",offset:{x:("x"in r?r.x:r[0])||0,y:("y"in r?r.y:r[1])||0}},i.options||{}),q=e.overlay({todo:p,opts:p.options,latLng:C(f)},!0),p.options.pane="floatShadow",p.options.content=a(document.createElement("div")).width(n.width+"px").height(n.height+"px"),shadow=e.overlay({todo:p,opts:p.options,latLng:C(f)},!0),i.data={latLng:C(f),markers:[]},a.each(f.indexes,function(a,b){i.data.markers.push(h.value(b)),h.marker(b)&&h.marker(b).setMap(null)}),g(d,{todo:i},shadow,b,{main:q,shadow:shadow}),h.store(f,q,shadow)):a.each(f.indexes,function(a,b){if(h.marker(b))h.marker(b).setMap(m);else{var e=h.todo(b),f=new c.classes.Marker(e.options);h.setMarker(b,f),g(d,{todo:e},f,e.id)}})}),h}var o,e=this,j=new h,l=new r,m=null;this._plan=function(a){for(var b=0;a.length>b;b++)j.add(new i(e,t,a[b]));s()},this.map=function(a){E(a.latLng,a),g(d,a,m),A(a,m)},this.destroy=function(a){l.clear(),d.empty(),m&&(m=null),A(a,!0)},this.infowindow=function(e){var f=[],h="values"in e.todo;h||(e.latLng?e.opts.position=e.latLng:e.opts.position&&(e.opts.position=C(e.opts.position)),e.todo.values=[{options:e.opts}]),a.each(e.todo.values,function(a,i){var j,n,o=k(e,i);m||E(o.options.position),n=new c.classes.InfoWindow(o.options),n&&(o.open===b||o.open)&&(h?n.open(m,o.anchor?o.anchor:b):n.open(m,o.anchor?o.anchor:e.latLng?b:e.session.marker?e.session.marker:b)),f.push(n),j=l.add({todo:o},"infowindow",n),g(d,{todo:o},n,j)}),A(e,h?f:f[0])},this.circle=function(b){var e=[],f="values"in b.todo;return f||(b.opts.center=b.latLng||C(b.opts.center),b.todo.values=[{options:b.opts}]),b.todo.values.length?(a.each(b.todo.values,function(a,f){var h,i,j=k(b,f);j.options.center=j.options.center?C(j.options.center):C(f),m||E(j.options.center),j.options.map=m,i=new c.classes.Circle(j.options),e.push(i),h=l.add({todo:j},"circle",i),g(d,{todo:j},i,h)}),A(b,f?e:e[0]),void 0):(A(b,!1),void 0)},this.overlay=function(b,d){var e,f,g=a(document.createElement("div")).css("border","none").css("borderWidth","0px").css("position","absolute");return g.append(b.opts.content),n.prototype=new c.classes.OverlayView,f=new n(m,b.opts,b.latLng,g),g=null,d?f:(e=l.add(b,"overlay",f),A(b,f,e),void 0)},this.getaddress=function(a){u(a,a.results,a.status),o.ack()},this.getlatlng=function(a){u(a,a.results,a.status),o.ack()},this.getmaxzoom=function(a){x().getMaxZoomAtLatLng(a.latLng,function(b){u(a,b.status===google.maps.MaxZoomStatus.OK?b.zoom:!1,status),o.ack()})},this.getelevation=function(a){var b,c=[],d=function(b,c){u(a,c===google.maps.ElevationStatus.OK?b:!1,c),o.ack()};if(a.latLng)c.push(a.latLng);else for(c=B(a.todo.locations||[]),b=0;c.length>b;b++)c[b]=C(c[b]);if(c.length)w().getElevationForLocations({locations:c},d);else{if(a.todo.path&&a.todo.path.length)for(b=0;a.todo.path.length>b;b++)c.push(C(a.todo.path[b]));c.length?w().getElevationAlongPath({path:c,samples:a.todo.samples},d):o.ack()}},this.defaults=function(b){a.each(b.todo,function(b,d){c[b]="object"==typeof c[b]?a.extend({},c[b],d):d}),o.ack(!0)},this.rectangle=function(b){var e=[],f="values"in b.todo;return f||(b.todo.values=[{options:b.opts}]),b.todo.values.length?(a.each(b.todo.values,function(a,f){var h,i,j=k(b,f);j.options.bounds=j.options.bounds?D(j.options.bounds):D(f),m||E(j.options.bounds.getCenter()),j.options.map=m,i=new c.classes.Rectangle(j.options),e.push(i),h=l.add({todo:j},"rectangle",i),g(d,{todo:j},i,h)}),A(b,f?e:e[0]),void 0):(A(b,!1),void 0)},this.polyline=function(a){F(a,"Polyline","path")},this.polygon=function(a){F(a,"Polygon","paths")},this.trafficlayer=function(a){E();var b=l.get("trafficlayer");b||(b=new c.classes.TrafficLayer,b.setMap(m),l.add(a,"trafficlayer",b)),A(a,b)},this.bicyclinglayer=function(a){E();var b=l.get("bicyclinglayer");b||(b=new c.classes.BicyclingLayer,b.setMap(m),l.add(a,"bicyclinglayer",b)),A(a,b)},this.groundoverlay=function(a){a.opts.bounds=D(a.opts.bounds),a.opts.bounds&&E(a.opts.bounds.getCenter());var b,d=new c.classes.GroundOverlay(a.opts.url,a.opts.bounds,a.opts.opts);d.setMap(m),b=l.add(a,"groundoverlay",d),A(a,d,b)},this.streetviewpanorama=function(b){b.opts.opts||(b.opts.opts={}),b.latLng?b.opts.opts.position=b.latLng:b.opts.opts.position&&(b.opts.opts.position=C(b.opts.opts.position)),b.todo.divId?b.opts.container=document.getElementById(b.todo.divId):b.opts.container&&(b.opts.container=a(b.opts.container).get(0));var d,e=new c.classes.StreetViewPanorama(b.opts.container,b.opts.opts);e&&m.setStreetView(e),d=l.add(b,"streetviewpanorama",e),A(b,e,d)},this.kmllayer=function(b){var e=[],f="values"in b.todo;return f||(b.todo.values=[{options:b.opts}]),b.todo.values.length?(a.each(b.todo.values,function(a,f){var h,i,j=k(b,f);m||E(),j.options.opts.map=m,i=new c.classes.KmlLayer(j.options.url,j.options.opts),e.push(i),h=l.add({todo:j},"kmllayer",i),g(d,{todo:j},i,h)}),A(b,f?e:e[0]),void 0):(A(b,!1),void 0)},this.panel=function(c){E();var e,h,f=0,g=0,i=a(document.createElement("div"));i.css("position","absolute").css("z-index","1000"),c.opts.content&&(h=a(c.opts.content),c.opts.left!==b?f=c.opts.left:c.opts.right!==b?f=d.width()-h.width()-c.opts.right:c.opts.center&&(f=(d.width()-h.width())/2),c.opts.top!==b?g=c.opts.top:c.opts.bottom!==b?g=d.height()-h.height()-c.opts.bottom:c.opts.middle&&(g=(d.height()-h.height())/2),i.css("top",g+"px").css("left",f+"px").append(h)),d.first().prepend(i),e=l.add(c,"panel",i),A(c,i,e),i=null},this.marker=function(b){var h="values"in b.todo,i=!m;if(h||(b.opts.position=b.latLng||C(b.opts.position),b.todo.values=[{options:b.opts}]),!b.todo.values.length)return A(b,!1),void 0;if(i&&E(),b.todo.cluster&&!m.getBounds())return google.maps.event.addListenerOnce(m,"bounds_changed",function(){e.marker.apply(e,[b])}),void 0;if(b.todo.cluster){var j,n;b.todo.cluster instanceof q?(j=b.todo.cluster,n=l.getById(j.id(),!0)):(n=G(b.todo.cluster),j=new q(f(b.todo.id,!0),n),l.add(b,"clusterer",j,n)),n.beginUpdate(),a.each(b.todo.values,function(a,c){var d=k(b,c);d.options.position=d.options.position?C(d.options.position):C(c),d.options.map=m,i&&(m.setCenter(d.options.position),i=!1),n.add(d,c)}),n.endUpdate(),A(b,j)}else{var o=[];a.each(b.todo.values,function(a,e){var f,h,j=k(b,e);j.options.position=j.options.position?C(j.options.position):C(e),j.options.map=m,i&&(m.setCenter(j.options.position),i=!1),h=new c.classes.Marker(j.options),o.push(h),f=l.add({todo:j},"marker",h),g(d,{todo:j},h,f)}),A(b,h?o:o[0])}},this.getroute=function(a){a.opts.origin=C(a.opts.origin,!0),a.opts.destination=C(a.opts.destination,!0),v().route(a.opts,function(b,c){u(a,c==google.maps.DirectionsStatus.OK?b:!1,c),o.ack()})},this.directionsrenderer=function(b){b.opts.map=m;var c,d=new google.maps.DirectionsRenderer(b.opts);b.todo.divId?d.setPanel(document.getElementById(b.todo.divId)):b.todo.container&&d.setPanel(a(b.todo.container).get(0)),c=l.add(b,"directionrenderer",d),A(b,d,c)},this.getgeoloc=function(a){A(a,a.latLng)},this.styledmaptype=function(a){E();var b=new c.classes.StyledMapType(a.todo.styles,a.opts);m.mapTypes.set(a.todo.id,b),A(a,b)},this.imagemaptype=function(a){E();var b=new c.classes.ImageMapType(a.opts);m.mapTypes.set(a.todo.id,b),A(a,b)},this.autofit=function(b){var c=new google.maps.LatLngBounds;a.each(l.all(),function(a,b){b.getPosition?c.extend(b.getPosition()):b.getBounds?(c.extend(b.getBounds().getNorthEast()),c.extend(b.getBounds().getSouthWest())):b.getPaths?b.getPaths().forEach(function(a){a.forEach(function(a){c.extend(a)})}):b.getPath?b.getPath().forEach(function(a){c.extend(a)}):b.getCenter&&c.extend(b.getCenter())}),c.isEmpty()||m.getBounds()&&m.getBounds().equals(c)||("maxZoom"in b.todo&&google.maps.event.addListenerOnce(m,"bounds_changed",function(){this.getZoom()>b.todo.maxZoom&&this.setZoom(b.todo.maxZoom)}),m.fitBounds(c)),A(b,!0)},this.clear=function(b){if("string"==typeof b.todo){if(l.clearById(b.todo)||l.objClearById(b.todo))return A(b,!0),void 0;b.todo={name:b.todo}}b.todo.id?a.each(B(b.todo.id),function(a,b){l.clearById(b)}):l.clear(B(b.todo.name),b.todo.last,b.todo.first,b.todo.tag),A(b,!0)},this.exec=function(b){var c=this;a.each(B(b.todo.func),function(e,f){a.each(c.get(b.todo,!0,b.todo.hasOwnProperty("full")?b.todo.full:!0),function(a,b){f.call(d,b)})}),A(b,!0)},this.get=function(c,d,e){var f,g,h=d?c:c.todo;return d||(e=h.full),"string"==typeof h?(g=l.getById(h,!1,e)||l.objGetById(h),g===!1&&(f=h,h={})):f=h.name,"map"===f&&(g=m),g||(g=[],h.id?(a.each(B(h.id),function(a,b){g.push(l.getById(b,!1,e)||l.objGetById(b))}),a.isArray(h.id)||(g=g[0])):(a.each(f?B(f):[b],function(b,c){var d;h.first?(d=l.get(c,!1,h.tag,e),d&&g.push(d)):h.all?a.each(l.all(c,h.tag,e),function(a,b){g.push(b)}):(d=l.get(c,!0,h.tag,e),d&&g.push(d))}),h.all||a.isArray(f)||(g=g[0]))),g=a.isArray(g)||!h.all?g:[g],d?g:(A(c,g),void 0)},this.getdistance=function(a){var b;for(a.opts.origins=B(a.opts.origins),b=0;a.opts.origins.length>b;b++)a.opts.origins[b]=C(a.opts.origins[b],!0);for(a.opts.destinations=B(a.opts.destinations),b=0;a.opts.destinations.length>b;b++)a.opts.destinations[b]=C(a.opts.destinations[b],!0);y().getDistanceMatrix(a.opts,function(b,c){u(a,c===google.maps.DistanceMatrixStatus.OK?b:!1,c),o.ack()})},this.trigger=function(b){if("string"==typeof b.todo)google.maps.event.trigger(m,b.todo);else{var c=[m,b.todo.eventName];b.todo.var_args&&a.each(b.todo.var_args,function(a,b){c.push(b)}),google.maps.event.trigger.apply(google.maps.event,c)}u(b),o.ack()}}function I(a){var b;if(!a.hasOwnProperty("get"))return!1;for(b in a)if("get"!==b)return!1;return!a.get.hasOwnProperty("callback")}var c,d=0,s={},t=new m;a.fn.gmap3=function(){var b,c=[],d=!0,f=[];for(e(),b=0;arguments.length>b;b++)arguments[b]&&c.push(arguments[b]);return c.length||c.push("map"),a.each(this,function(){var b=a(this),e=b.data("gmap3");d=!1,e||(e=new H(b),b.data("gmap3",e)),1!==c.length||"get"!==c[0]&&!I(c[0])?e._plan(c):f.push(e.get("get"===c[0]?"map":c[0].get,!0))}),f.length?1===f.length?f[0]:f:this}})(jQuery);